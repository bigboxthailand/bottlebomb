<!DOCTYPE html>
<html>
<head>
    <title>ส่งข้อมูลแบบ POST</title>
</head>
<body>
    <h1>ส่งข้อมูลแบบ POST</h1>
    <button onclick="sendData()">ส่งข้อมูล v4</button>

    <script>
        function sendData() {
            const url = "https://script.google.com/macros/s/AKfycbwf4xA2CIQu2H70lBNadHFU8Ryd3BAWvBW9IHkA6q_l-5KxwjZazv_MrlJ66Fkt49DURw/exec";
            const raw = JSON.stringify({
                "userId": "U1234567890",
                "firstName": "สมชาย",
                "lastName": "ใจดี",
                "studentId": "123456",
                "phoneNumber": "0801234567"
            });

            fetch(url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: raw,
                mode: 'no-cors'
            })
            .then(response => response.json())
            .then(data => {
                console.log("Response:", data);
                alert("ส่งข้อมูลสำเร็จ");
            })
            .catch(error => {
                console.error("Error:", error);
                alert("เกิดข้อผิดพลาดในการส่งข้อมูล");
            });
        }
    </script>
</body>
</html>
